HAIRSTYLE_DESCRIPTIONS = {
    # Heart-shaped face styles
    "heart": {
        "Short": {
            "pixie_cut": {
                "name": "Textured Pixie Cut",
                "description": "A short, choppy pixie cut with longer layers on top to balance your heart-shaped face.",
                "barber_instructions": "Ask for a textured pixie cut with longer layers on top that can be swept to the side. Request texture through the crown and keep some length around the ears and nape."
            },
            "bob_with_bangs": {
                "name": "Bob with Side-Swept Bangs",
                "description": "A chin-length bob with side-swept bangs that soften your forehead and highlight your cheekbones.",
                "barber_instructions": "Request a chin-length bob with textured ends and side-swept bangs that graze your eyebrows. Ask for layers that frame your face to soften your jawline."
            },
            "layered_crop": {
                "name": "Layered Crop",
                "description": "A short, layered cut with volume at the sides to balance your heart-shaped face's narrower chin.",
                "barber_instructions": "Ask for a short crop with layers that add width at the jaw area. Request textured ends and a longer top section that can be styled forward."
            },
            "textured_bowl_cut": {
                "name": "Modern Textured Bowl Cut",
                "description": "A modern bowl cut with texture throughout that balances your forehead and adds fullness around the jawline.",
                "barber_instructions": "Request a bowl cut shape with heavily texturized ends. Ask for it to be slightly longer around the jawline to add width."
            }
        },
        "Long": {
            "long_layers": {
                "name": "Long Layers with Side-Swept Bangs",
                "description": "Long, flowing layers with side-swept bangs that balance your wider forehead and narrower chin.",
                "barber_instructions": "Ask for long layers starting at chin level and face-framing pieces. Request side-swept bangs that blend into the layers and soften your forehead."
            },
            "wavy_lob": {
                "name": "Wavy Long Bob (Lob)",
                "description": "A shoulder-length bob with soft waves that add volume around your jawline to balance your heart-shaped face.",
                "barber_instructions": "Request a shoulder-length bob with long layers throughout and textured ends. Mention you want it to be styled with soft waves to add volume around your jawline."
            },
            "curtain_bangs": {
                "name": "Long Hair with Curtain Bangs",
                "description": "Long hair with face-framing curtain bangs that soften your forehead and add width to your chin area.",
                "barber_instructions": "Ask for long layers with curtain bangs that part in the center and frame your face. The bangs should be longer at the sides, grazing your cheekbones."
            },
            "layered_shag": {
                "name": "Layered Shag with Bangs",
                "description": "A medium to long shag cut with lots of layers and bangs that minimize forehead width and add fullness around the jawline.",
                "barber_instructions": "Request a shaggy cut with lots of layers throughout, especially around the jawline. Add wispy bangs that hit just at or above the eyebrows."
            }
        },
        "Updo": {
            "messy_updo": {
                "name": "Messy Top Knot with Face-Framing Pieces",
                "description": "A relaxed top knot with loose strands that frame your face and soften your features.",
                "barber_instructions": "Ask for an updo that allows for face-framing pieces to be left out. Request a style that's not too tight at the temples to avoid emphasizing your wider forehead."
            },
            "half_up": {
                "name": "Half-Up Style with Volume",
                "description": "A half-up style with volume at the crown that balances your heart-shaped face.",
                "barber_instructions": "Request a half-up style with volume at the crown. Ask for face-framing pieces to be left loose to soften your jawline."
            },
            "low_side_bun": {
                "name": "Low Side Bun with Soft Tendrils",
                "description": "A low bun positioned to one side with soft tendrils that frame your face and add width to your chin area.",
                "barber_instructions": "Ask for layers that can be left out when styling a low side bun. Request face-framing pieces that will soften your facial features."
            },
            "braided_crown": {
                "name": "Braided Crown with Volume",
                "description": "A crown braid that adds width at the jawline and softens your forehead, perfect for heart-shaped faces.",
                "barber_instructions": "Request long layers that can be braided into a crown style. Ask for wispy pieces to be left out around the face to soften the forehead."
            }
        }
    },
    
    # Oval-shaped face styles
    "oval": {
        "Short": {
            "pixie_cut": {
                "name": "Classic Pixie Cut",
                "description": "A short, classic pixie cut that showcases your balanced oval face shape and highlights your eyes.",
                "barber_instructions": "Ask for a classic pixie cut with short sides and slightly longer top. Request textured layers on top for movement and versatility."
            },
            "french_bob": {
                "name": "French Bob",
                "description": "A chin-length bob with or without bangs that perfectly frames your oval face.",
                "barber_instructions": "Request a chin-length bob with blunt ends. For bangs, ask for them to hit just at or above your eyebrows for a classic French bob look."
            },
            "textured_crop": {
                "name": "Textured Crop with Fade",
                "description": "A short, textured crop with a fade that emphasizes your balanced facial features.",
                "barber_instructions": "Ask for a short crop with texture on top, faded sides, and a clean neckline. Request enough length on top to style with some movement."
            },
            "short_shag": {
                "name": "Short Shaggy Cut",
                "description": "A short, shaggy cut with lots of layers and texture that frames your oval face beautifully.",
                "barber_instructions": "Request a short, layered cut with lots of texture throughout. Ask for piece-y, choppy ends and some face-framing layers."
            }
        },
        "Long": {
            "long_layers": {
                "name": "Long Layers with Center Part",
                "description": "Long hair with subtle layers and a center part that showcases your balanced oval face.",
                "barber_instructions": "Ask for long layers starting at collarbone level with face-framing pieces. Mention you want it styled with a center part to highlight your balanced features."
            },
            "beach_waves": {
                "name": "Beach Waves",
                "description": "Effortless beach waves that add texture and movement to complement your oval face.",
                "barber_instructions": "Request long layers with textured ends that can be easily styled into beach waves. Ask for face-framing layers starting at chin level."
            },
            "blunt_lob": {
                "name": "Blunt Long Bob",
                "description": "A sleek, blunt long bob that hits at the collarbone and emphasizes your oval face's perfect proportions.",
                "barber_instructions": "Ask for a blunt cut at collarbone length with minimal layers. The ends should be cut straight across for a bold, modern look."
            },
            "curtain_bangs_long": {
                "name": "Long Layers with Curtain Bangs",
                "description": "Long, flowing hair with face-framing curtain bangs that highlight your cheekbones and eyes.",
                "barber_instructions": "Request long, subtle layers with face-framing curtain bangs that part in the middle. The bangs should blend into face-framing layers."
            }
        },
        "Updo": {
            "sleek_updo": {
                "name": "Sleek High Ponytail",
                "description": "A sleek, high ponytail that showcases your balanced facial features and creates an elegant look.",
                "barber_instructions": "Ask for a style that can be pulled into a sleek high ponytail. Request face-framing layers if you want the option to leave some pieces out."
            },
            "low_bun": {
                "name": "Low Textured Bun",
                "description": "A low, textured bun with loose strands that frame your face for a soft, romantic look.",
                "barber_instructions": "Request layers around your face that can be left out when styling a low bun. Ask for texture throughout the hair to create a more voluminous bun."
            },
            "braided_updo": {
                "name": "Braided Updo",
                "description": "An elegant braided updo that highlights your balanced oval face shape and shows off your facial features.",
                "barber_instructions": "Ask for long layers that can be incorporated into a braided updo. Request face-framing pieces that can be left loose if desired."
            },
            "top_knot": {
                "name": "Sleek Top Knot",
                "description": "A polished top knot that emphasizes your cheekbones and jawline, perfect for your oval face.",
                "barber_instructions": "Request a cut that allows for a sleek top knot. The hair should be long enough to gather into a high bun with no stray pieces."
            }
        }
    },
    
    # Round-shaped face styles
    "round": {
        "Short": {
            "pixie_with_volume": {
                "name": "Pixie with Volume on Top",
                "description": "A pixie cut with added height on top to elongate your round face.",
                "barber_instructions": "Request a pixie cut with shorter sides and longer top. Ask for lots of texture on top that can be styled upward to add height to your face."
            },
            "asymmetric_bob": {
                "name": "Asymmetric Bob",
                "description": "An asymmetric bob that's longer on one side to create angles that contrast with your round face.",
                "barber_instructions": "Ask for an asymmetric bob that's shorter on one side and gradually gets longer on the other. Request layers throughout to add texture and movement."
            },
            "undercut_pixie": {
                "name": "Undercut Pixie",
                "description": "A bold pixie cut with an undercut that adds edge and creates angles to contrast your round face.",
                "barber_instructions": "Request a pixie cut with an undercut on one or both sides. Keep length on top that can be styled with volume to elongate your face."
            },
            "layered_bob": {
                "name": "Heavily Layered Bob",
                "description": "A chin-length bob with lots of layers that create angles and reduce fullness around your cheeks.",
                "barber_instructions": "Ask for a chin-length bob with lots of layers throughout. The cut should be slightly longer in front to create a slimming angle along your face."
            }
        },
        "Long": {
            "long_layers_deep_side_part": {
                "name": "Long Layers with Deep Side Part",
                "description": "Long hair with layers and a deep side part that creates asymmetry to elongate your round face.",
                "barber_instructions": "Request long layers starting at chin level with a deep side part. The layers should frame your face and create vertical lines to slim your features."
            },
            "face_framing_layers": {
                "name": "Face-Framing Layers",
                "description": "Long hair with face-framing layers that start below the chin to elongate your round face.",
                "barber_instructions": "Ask for face-framing layers that start below the chin (not at the cheekbones). These longer layers create vertical lines that slim your face."
            },
            "waterfall_layers": {
                "name": "Waterfall Layers",
                "description": "Long hair with cascading layers that create vertical lines to elongate your round face.",
                "barber_instructions": "Request long layers that cascade down like a waterfall, starting at the chin or lower. These create vertical lines that slim your face."
            },
            "long_shag": {
                "name": "Long Shag with Curtain Bangs",
                "description": "A long, shaggy cut with curtain bangs that frame your face and create angles to offset roundness.",
                "barber_instructions": "Ask for a long shag cut with lots of layers throughout and curtain bangs that open at the center of your forehead and frame your face."
            }
        },
        "Updo": {
            "high_ponytail": {
                "name": "High Ponytail with Volume",
                "description": "A high ponytail with volume at the crown that elongates your round face.",
                "barber_instructions": "Request a style that can be pulled into a high ponytail with volume at the crown. Ask for face-framing pieces that can be left out to slim your face."
            },
            "top_knot_height": {
                "name": "Top Knot with Height",
                "description": "A high top knot that adds height to elongate your round face.",
                "barber_instructions": "Ask for a cut that allows for a high top knot with added height. Request face-framing layers that can be left out to create slimming angles."
            },
            "half_up_teased": {
                "name": "Half-Up Style with Teased Crown",
                "description": "A half-up style with a teased crown that adds height and elongates your round face.",
                "barber_instructions": "Request layers that can be styled into a half-up look with volume at the crown. The layers should frame your face below the chin."
            },
            "side_swept_updo": {
                "name": "Side-Swept Updo",
                "description": "An asymmetrical updo with volume on one side that creates angles to offset your round face.",
                "barber_instructions": "Ask for a style that can be gathered into a side-swept updo. Request layers that can add asymmetry and angles to your face."
            }
        }
    },
    
    # Square-shaped face styles
    "square": {
        "Short": {
            "textured_pixie": {
                "name": "Soft Textured Pixie",
                "description": "A pixie cut with soft layers and texture that soften your square jawline.",
                "barber_instructions": "Ask for a pixie cut with soft, wispy layers and texture throughout. Request rounded edges rather than blunt lines to soften your square jawline."
            },
            "side_swept_bob": {
                "name": "Side-Swept Bob",
                "description": "A bob with side-swept bangs and soft layers that offset the angles of your square face.",
                "barber_instructions": "Request a bob with soft layers and side-swept bangs. Ask for textured, not blunt, ends to avoid adding more angles to your face."
            },
            "layered_pixie_bob": {
                "name": "Layered Pixie Bob",
                "description": "A short, layered cut between a pixie and bob that softens your square jawline with rounded edges.",
                "barber_instructions": "Ask for a cut that's between a pixie and bob with lots of layers and soft edges. Request wispy ends that curve inward slightly at the jaw."
            },
            "textured_crop_soft": {
                "name": "Soft Textured Crop",
                "description": "A short crop with soft texture and wispy edges that soften the angles of your square face.",
                "barber_instructions": "Request a short crop with lots of texture and soft, wispy edges. Ask for rounded lines rather than geometric shapes."
            }
        },
        "Long": {
            "long_waves": {
                "name": "Long Soft Waves",
                "description": "Long hair styled in soft waves that soften the angles of your square face.",
                "barber_instructions": "Ask for long layers that can be styled into soft waves. Request face-framing layers that start at the cheekbones to soften your jawline."
            },
            "rounded_layers": {
                "name": "Rounded Layers",
                "description": "Long hair with rounded layers that curve inward at the jaw to soften your square face.",
                "barber_instructions": "Request long, face-framing layers that curve inward at the jaw. These should be cut to naturally fall in a rounded shape around your face."
            },
            "wispy_bangs_long": {
                "name": "Long Layers with Wispy Bangs",
                "description": "Long layers with soft, wispy bangs that break up the straight lines of your square face.",
                "barber_instructions": "Ask for long layers with soft, wispy bangs that blend into face-framing pieces. The bangs should be light and airy, not blunt."
            },
            "center_part_waves": {
                "name": "Center Part with Soft Waves",
                "description": "Long hair with a center part and soft waves that frame and soften your square jawline.",
                "barber_instructions": "Request long layers that can be styled with a center part and soft waves. Ask for face-framing pieces that soften your jawline."
            }
        },
        "Updo": {
            "loose_updo": {
                "name": "Loose, Messy Updo",
                "description": "A loose, slightly messy updo with soft tendrils that soften the angles of your square face.",
                "barber_instructions": "Ask for layers that can be styled into a loose updo. Request face-framing pieces that can be left out to soften your angular jawline."
            },
            "low_side_bun_soft": {
                "name": "Soft Low Side Bun",
                "description": "A low side bun with loose strands that frame your face and soften your square jawline.",
                "barber_instructions": "Request a cut that allows for a low side bun with softness around the face. Ask for layers that can be left out to create softness."
            },
            "tousled_ponytail": {
                "name": "Tousled Ponytail",
                "description": "A textured, slightly messy ponytail with volume and face-framing pieces that soften your square face.",
                "barber_instructions": "Ask for layers that create a textured ponytail with volume. Request face-framing pieces that can be left out to soften your angular features."
            },
            "half_up_waves": {
                "name": "Half-Up with Soft Waves",
                "description": "A half-up style with soft waves that add movement and soften the angles of your square face.",
                "barber_instructions": "Request long layers that can be styled into a half-up look with soft waves. Ask for face-framing pieces that soften your jawline."
            }
        }
    },
    
    # Long-shaped face styles
    "long": {
        "Short": {
            "blunt_bob": {
                "name": "Blunt Bob with Bangs",
                "description": "A blunt bob with straight-across bangs that shorten your long face and highlight your eyes.",
                "barber_instructions": "Ask for a blunt bob that hits at chin level with straight-across bangs. The horizontal lines will help shorten the appearance of your face."
            },
            "textured_lob_bangs": {
                "name": "Textured Lob with Full Bangs",
                "description": "A textured long bob with full bangs that create width and shorten your long face.",
                "barber_instructions": "Request a textured long bob that hits at the collarbone with full, straight-across bangs. Ask for layers that add volume at the sides."
            },
            "shaggy_bob": {
                "name": "Shaggy Bob with Layers",
                "description": "A shaggy bob with lots of layers that add width to balance your long face.",
                "barber_instructions": "Ask for a shaggy bob with lots of layers throughout to add width. Request a length that hits between your chin and shoulders."
            },
            "curly_bob": {
                "name": "Curly Bob",
                "description": "A curly or wavy bob that adds width and volume at the sides to balance your long face.",
                "barber_instructions": "Request a bob cut that works with your natural texture or can be styled curly. Ask for a shape that adds width at the sides of your face."
            }
        },
        "Long": {
            "long_bangs": {
                "name": "Long Layers with Full Bangs",
                "description": "Long, layered hair with full, straight-across bangs that shorten your long face.",
                "barber_instructions": "Ask for long layers with full, straight-across bangs. The bangs should hit at or just below your eyebrows to create a horizontal line."
            },
            "side_part_waves": {
                "name": "Side Part with Voluminous Waves",
                "description": "Long hair with a side part and voluminous waves that add width to balance your long face.",
                "barber_instructions": "Request long layers with a side part that can be styled into voluminous waves. Ask for layers that add width at the sides of your face."
            },
            "textured_mid_length": {
                "name": "Textured Mid-Length Cut",
                "description": "A textured, mid-length cut with layers that add volume at the sides to balance your long face.",
                "barber_instructions": "Ask for a mid-length cut (between chin and collarbone) with lots of texture and layers that add width at the cheeks and jawline."
            },
            "curtain_bangs_width": {
                "name": "Long Layers with Curtain Bangs",
                "description": "Long layers with curtain bangs that add width across the forehead and cheekbones to balance your long face.",
                "barber_instructions": "Request long layers with curtain bangs that open from the center and extend to the cheekbones. These create width across your face."
            }
        },
        "Updo": {
            "low_voluminous_updo": {
                "name": "Low Voluminous Updo",
                "description": "A low updo with volume at the sides that adds width to balance your long face.",
                "barber_instructions": "Ask for a style that can be gathered into a low updo with volume at the sides. Request layers that add fullness around your cheeks."
            },
            "wide_chignon": {
                "name": "Wide Chignon",
                "description": "A chignon styled to add width rather than height, balancing your long face beautifully.",
                "barber_instructions": "Request a cut that allows for a wide, rather than tall, chignon. The style should add width at the sides of your face."
            },
            "side_swept_updo_full": {
                "name": "Full Side-Swept Updo",
                "description": "A side-swept updo with fullness that adds width to balance your long face.",
                "barber_instructions": "Ask for a style that can be gathered into a side-swept updo with fullness. Request layers that create width rather than height."
            },
            "low_ponytail_volume": {
                "name": "Low Ponytail with Volume",
                "description": "A low ponytail with volume at the sides and top that balances your long face shape.",
                "barber_instructions": "Request a cut that allows for a low ponytail with volume at the sides. Ask for layers that add fullness around your cheeks and crown."
            }
        }
    }
}

# Fallback descriptions if specific style isn't found
DEFAULT_DESCRIPTIONS = {
    "heart": {
        "Short": {
            "name": "Textured Short Cut",
            "description": "A textured short cut that balances your heart-shaped face by adding volume at the jawline.",
            "barber_instructions": "Ask for a textured cut with layers that add volume around your jawline. Keep some length on top with side-swept styling."
        },
        "Long": {
            "name": "Long Layers with Side Part",
            "description": "Long layers with a side part that softens your forehead and highlights your cheekbones.",
            "barber_instructions": "Request long layers starting at chin level with a side part. Ask for face-framing pieces to soften your features."
        },
        "Updo": {
            "name": "Soft Updo with Face-Framing Pieces",
            "description": "A soft updo with face-framing pieces that balance your heart-shaped face.",
            "barber_instructions": "Ask for an updo that isn't too tight at the temples and leaves face-framing pieces out to soften your features."
        }
    },
    "oval": {
        "Short": {
            "name": "Versatile Short Cut",
            "description": "A versatile short cut that showcases your balanced oval face shape.",
            "barber_instructions": "Request a short cut with textured layers. With your oval face, you can experiment with almost any style."
        },
        "Long": {
            "name": "Long Layered Cut",
            "description": "A long, layered cut that frames your balanced oval face beautifully.",
            "barber_instructions": "Ask for long layers that frame your face. Your oval shape works well with almost any style, so you can personalize as desired."
        },
        "Updo": {
            "name": "Classic Updo",
            "description": "A classic updo that highlights your balanced facial features.",
            "barber_instructions": "Request a cut that can be styled into various updos. Your oval face shape is versatile and works with most updo styles."
        }
    },
    "round": {
        "Short": {
            "name": "Short Cut with Height",
            "description": "A short cut with added height that elongates your round face.",
            "barber_instructions": "Ask for a short cut with volume on top to add height. Request shorter sides to slim your face shape."
        },
        "Long": {
            "name": "Long Layers with Length",
            "description": "Long layers that create vertical lines to elongate your round face.",
            "barber_instructions": "Request long layers that start below the chin to create vertical lines. Ask for a side part to add asymmetry."
        },
        "Updo": {
            "name": "Height-Adding Updo",
            "description": "An updo with height at the crown that elongates your round face.",
            "barber_instructions": "Ask for a style that can be gathered into an updo with volume at the crown. Request face-framing pieces that slim your face."
        }
    },
    "square": {
        "Short": {
            "name": "Soft Short Cut",
            "description": "A soft, textured short cut that softens the angles of your square face.",
            "barber_instructions": "Request a short cut with soft layers and texture. Ask for rounded rather than blunt edges to soften your angular jawline."
        },
        "Long": {
            "name": "Soft Layered Cut",
            "description": "A layered cut with soft edges that balance the angles of your square face.",
            "barber_instructions": "Ask for layers that soften your angular jawline. Request textured, not blunt, ends and face-framing pieces."
        },
        "Updo": {
            "name": "Soft, Loose Updo",
            "description": "A soft, loose updo with face-framing pieces that soften your square jawline.",
            "barber_instructions": "Request a style that can be gathered into a loose updo. Ask for face-framing pieces that soften your angular features."
        }
    },
    "long": {
        "Short": {
            "name": "Width-Adding Short Cut",
            "description": "A short cut that adds width to balance your long face shape.",
            "barber_instructions": "Ask for a short cut with layers that add width at the sides. Consider adding bangs to shorten the appearance of your face."
        },
        "Long": {
            "name": "Layered Cut with Bangs",
            "description": "A layered cut with bangs that shorten and add width to your long face.",
            "barber_instructions": "Request layers that add width at the cheeks and jawline. Consider bangs to create a horizontal line that shortens your face."
        },
        "Updo": {
            "name": "Low, Wide Updo",
            "description": "A low updo with width that balances your long face shape.",
            "barber_instructions": "Ask for a style that can be gathered into a low updo with width rather than height. Request fullness at the sides of your face."
        }
    }
}

def get_hairstyle_description(face_shape, hair_length, style_filename):
    """
    Get the appropriate hairstyle description based on face shape, hair length, and style.
    Falls back to default descriptions if specific style isn't found.
    
    Args:
        face_shape (str): The face shape (heart, oval, round, square, long)
        hair_length (str): The hair length category (Short, Long, Updo)
        style_filename (str): The filename of the style image to match against known styles
        
    Returns:
        dict: A dictionary containing name, description, and barber_instructions
    """
    face_shape = face_shape.lower()
    
    # Check if we have this face shape in our descriptions
    if face_shape not in HAIRSTYLE_DESCRIPTIONS:
        return {
            "name": f"Hairstyle for {face_shape.title()} Face",
            "description": f"A flattering style for your {face_shape} face shape.",
            "barber_instructions": "Show your stylist this image for reference."
        }
    
    # Check if we have this hair length for this face shape
    if hair_length not in HAIRSTYLE_DESCRIPTIONS[face_shape]:
        # Fall back to default
        default_description = DEFAULT_DESCRIPTIONS.get(face_shape, {}).get(hair_length, {
            "name": f"{hair_length} Style for {face_shape.title()} Face",
            "description": f"A {hair_length.lower()} hairstyle that flatters your {face_shape} face shape.",
            "barber_instructions": "Show your stylist this image for reference."
        })
        
        # Format the barber instructions with line breaks
        if "barber_instructions" in default_description:
            default_description["barber_instructions"] = format_barber_instructions(default_description["barber_instructions"])
            
        return default_description
    
    # Try to match the filename to a specific style
    # This is a simple string matching approach - you may need to improve this
    # based on your actual filename patterns
    style_keys = HAIRSTYLE_DESCRIPTIONS[face_shape][hair_length].keys()
    
    for key in style_keys:
        if key.lower() in style_filename.lower():
            result = HAIRSTYLE_DESCRIPTIONS[face_shape][hair_length][key].copy()
            # Format the barber instructions with line breaks
            result["barber_instructions"] = format_barber_instructions(result["barber_instructions"])
            return result
    
    # No match found, return the first style as fallback
    result = next(iter(HAIRSTYLE_DESCRIPTIONS[face_shape][hair_length].values())).copy()
    # Format the barber instructions with line breaks
    result["barber_instructions"] = format_barber_instructions(result["barber_instructions"])
    return result

def format_barber_instructions(instructions):
    """
    Format barber instructions to put each sentence on a new line.
    
    Args:
        instructions (str): The original instructions string
        
    Returns:
        str: Formatted instructions with each sentence on a new line
    """
    # Split by period followed by a space, and join with period + newline
    sentences = instructions.split('. ')
    # Add periods back except for the last sentence if it doesn't end with a period
    formatted = ''
    for i, sentence in enumerate(sentences):
        if i < len(sentences) - 1 or sentence.endswith('.'):
            if not sentence.endswith('.'):
                formatted += sentence + '.\n'
            else:
                formatted += sentence + '\n'
        else:
            formatted += sentence
    
    return formatted